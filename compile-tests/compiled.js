var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){if(b.get||b.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[c]=b.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var c=0;return $jscomp.iteratorPrototype(function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.array=$jscomp.array||{};$jscomp.iteratorFromArray=function(a,c){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var b=0,d={next:function(){if(b<a.length){var e=b++;return{value:c(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
$jscomp.polyfill=function(a,c,b,d){if(c){b=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in b||(b[e]={});b=b[e]}a=a[a.length-1];d=b[a];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6-impl","es3");
$jscomp.checkStringArgs=function(a,c,b){if(null==a)throw new TypeError("The 'this' value for String.prototype."+b+" must not be null or undefined");if(c instanceof RegExp)throw new TypeError("First argument to String.prototype."+b+" must not be a regular expression");return a+""};
$jscomp.polyfill("String.prototype.repeat",function(a){return a?a:function(a){var b=$jscomp.checkStringArgs(this,null,"repeat");if(0>a||1342177279<a)throw new RangeError("Invalid count value");a|=0;for(var c="";a;)if(a&1&&(c+=b),a>>>=1)b+=b;return c}},"es6-impl","es3");
var Stats=function(){function a(a){d.appendChild(a.dom);return a}function c(a){for(var c=0;c<d.children.length;c++)d.children[c].style.display=c===a?"block":"none";b=a}var b=0,d=document.createElement("div");d.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000";d.addEventListener("click",function(a){a.preventDefault();c(++b%d.children.length)},!1);var e=(performance||Date).now(),f=e,g=0,h=a(new Stats.Panel("FPS","#0ff","#002")),k=a(new Stats.Panel("MS","#0f0","#020"));
if(self.performance&&self.performance.memory)var m=a(new Stats.Panel("MB","#f08","#201"));c(0);return{REVISION:16,dom:d,addPanel:a,showPanel:c,begin:function(){e=(performance||Date).now()},end:function(){g++;var a=(performance||Date).now();k.update(a-e,200);if(a>f+1E3&&(h.update(1E3*g/(a-f),100),f=a,g=0,m)){var b=performance.memory;m.update(b.usedJSHeapSize/1048576,b.jsHeapSizeLimit/1048576)}return a},update:function(){e=this.end()},domElement:d,setMode:c}};
Stats.Panel=function(a,c,b){var d=Infinity,e=0,f=Math.round,g=f(window.devicePixelRatio||1),h=80*g,k=48*g,m=3*g,w=2*g,p=3*g,n=15*g,y=74*g,u=30*g,t=document.createElement("canvas");t.width=h;t.height=k;t.style.cssText="width:80px;height:48px";var q=t.getContext("2d");q.font="bold "+9*g+"px Helvetica,Arial,sans-serif";q.textBaseline="top";q.fillStyle=b;q.fillRect(0,0,h,k);q.fillStyle=c;q.fillText(a,m,w);q.fillRect(p,n,y,u);q.fillStyle=b;q.globalAlpha=.9;q.fillRect(p,n,y,u);return{dom:t,update:function(k,
z){d=Math.min(d,k);e=Math.max(e,k);q.fillStyle=b;q.globalAlpha=1;q.fillRect(0,0,h,n);q.fillStyle=c;q.fillText(f(k)+" "+a+" ("+f(d)+"-"+f(e)+")",m,w);q.drawImage(t,p+g,n,y-g,u,p,n,y-g,u);q.fillRect(p+y-g,n,g,u);q.fillStyle=b;q.globalAlpha=.9;q.fillRect(p+y-g,n,g,f((1-k/z)*u))}}};"object"===typeof module&&(module.exports=Stats);
var TWEEN=TWEEN||function(){var a=[];return{getAll:function(){return a},removeAll:function(){a=[]},add:function(c){a.push(c)},remove:function(c){c=a.indexOf(c);-1!==c&&a.splice(c,1)},update:function(c,b){if(0===a.length)return!1;var d=0;for(c=void 0!==c?c:TWEEN.now();d<a.length;)a[d].update(c)||b?d++:a.splice(d,1);return!0}}}();
!function(){void 0===this.window&&void 0!==this.process?TWEEN.now=function(){var a=process.hrtime();return 1E3*a[0]+a[1]/1E3}:void 0!==this.window&&void 0!==window.performance&&void 0!==window.performance.now?TWEEN.now=window.performance.now.bind(window.performance):void 0!==Date.now?TWEEN.now=Date.now:TWEEN.now=function(){return(new Date).getTime()}}();
TWEEN.Tween=function(a){var c={},b={},d={},e=1E3,f=0,g=!1,h=!1,k=0,m=null,w=TWEEN.Easing.Linear.None,p=TWEEN.Interpolation.Linear,n=[],y=null,u=!1,t=null,q=null,v=null,z;for(z in a)c[z]=parseFloat(a[z],10);this.to=function(a,c){return void 0!==c&&(e=c),b=a,this};this.start=function(e){TWEEN.add(this);h=!0;u=!1;m=void 0!==e?e:TWEEN.now();m+=k;for(var f in b){if(b[f]instanceof Array){if(0===b[f].length)continue;b[f]=[a[f]].concat(b[f])}void 0!==c[f]&&(c[f]=a[f],0==c[f]instanceof Array&&(c[f]*=1),d[f]=
c[f]||0)}return this};this.stop=function(){return h?(TWEEN.remove(this),h=!1,null!==v&&v.call(a),this.stopChainedTweens(),this):this};this.stopChainedTweens=function(){for(var a=0,b=n.length;b>a;a++)n[a].stop()};this.delay=function(a){return k=a,this};this.repeat=function(a){return f=a,this};this.yoyo=function(a){return g=a,this};this.easing=function(a){return w=a,this};this.interpolation=function(a){return p=a,this};this.chain=function(){return n=arguments,this};this.onStart=function(a){return y=
a,this};this.onUpdate=function(a){return t=a,this};this.onComplete=function(a){return q=a,this};this.onStop=function(a){return v=a,this};this.update=function(h){var v,z,E;if(m>h)return!0;!1===u&&(null!==y&&y.call(a),u=!0);z=(h-m)/e;z=1<z?1:z;E=w(z);for(v in b)if(void 0!==c[v]){var C=c[v]||0,A=b[v];A instanceof Array?a[v]=p(A,E):("string"==typeof A&&(A="+"===A.charAt(0)||"-"===A.charAt(0)?C+parseFloat(A,10):parseFloat(A,10)),"number"==typeof A&&(a[v]=C+(A-C)*E))}if(null!==t&&t.call(a,E),1===z){if(0<
f){isFinite(f)&&f--;for(v in d){if("string"==typeof b[v]&&(d[v]+=parseFloat(b[v],10)),g)z=d[v],d[v]=b[v],b[v]=z;c[v]=d[v]}return m=h+k,!0}null!==q&&q.call(a);h=0;for(v=n.length;v>h;h++)n[h].start(m+e);return!1}return!0}};
TWEEN.Easing={Linear:{None:function(a){return a}},Quadratic:{In:function(a){return a*a},Out:function(a){return a*(2-a)},InOut:function(a){return 1>(a*=2)?.5*a*a:-.5*(--a*(a-2)-1)}},Cubic:{In:function(a){return a*a*a},Out:function(a){return--a*a*a+1},InOut:function(a){return 1>(a*=2)?.5*a*a*a:.5*((a-=2)*a*a+2)}},Quartic:{In:function(a){return a*a*a*a},Out:function(a){return 1- --a*a*a*a},InOut:function(a){return 1>(a*=2)?.5*a*a*a*a:-.5*((a-=2)*a*a*a-2)}},Quintic:{In:function(a){return a*a*a*a*a},Out:function(a){return--a*
a*a*a*a+1},InOut:function(a){return 1>(a*=2)?.5*a*a*a*a*a:.5*((a-=2)*a*a*a*a+2)}},Sinusoidal:{In:function(a){return 1-Math.cos(a*Math.PI/2)},Out:function(a){return Math.sin(a*Math.PI/2)},InOut:function(a){return.5*(1-Math.cos(Math.PI*a))}},Exponential:{In:function(a){return 0===a?0:Math.pow(1024,a-1)},Out:function(a){return 1===a?1:1-Math.pow(2,-10*a)},InOut:function(a){return 0===a?0:1===a?1:1>(a*=2)?.5*Math.pow(1024,a-1):.5*(-Math.pow(2,-10*(a-1))+2)}},Circular:{In:function(a){return 1-Math.sqrt(1-
a*a)},Out:function(a){return Math.sqrt(1- --a*a)},InOut:function(a){return 1>(a*=2)?-.5*(Math.sqrt(1-a*a)-1):.5*(Math.sqrt(1-(a-=2)*a)+1)}},Elastic:{In:function(a){return 0===a?0:1===a?1:-Math.pow(2,10*(a-1))*Math.sin(5*(a-1.1)*Math.PI)},Out:function(a){return 0===a?0:1===a?1:Math.pow(2,-10*a)*Math.sin(5*(a-.1)*Math.PI)+1},InOut:function(a){return 0===a?0:1===a?1:(a*=2,1>a?-.5*Math.pow(2,10*(a-1))*Math.sin(5*(a-1.1)*Math.PI):.5*Math.pow(2,-10*(a-1))*Math.sin(5*(a-1.1)*Math.PI)+1)}},Back:{In:function(a){return a*
a*(2.70158*a-1.70158)},Out:function(a){return--a*a*(2.70158*a+1.70158)+1},InOut:function(a){return 1>(a*=2)?.5*a*a*(3.5949095*a-2.5949095):.5*((a-=2)*a*(3.5949095*a+2.5949095)+2)}},Bounce:{In:function(a){return 1-TWEEN.Easing.Bounce.Out(1-a)},Out:function(a){return 1/2.75>a?7.5625*a*a:2/2.75>a?7.5625*(a-=1.5/2.75)*a+.75:2.5/2.75>a?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375},InOut:function(a){return.5>a?.5*TWEEN.Easing.Bounce.In(2*a):.5*TWEEN.Easing.Bounce.Out(2*a-1)+.5}}};
TWEEN.Interpolation={Linear:function(a,c){var b=a.length-1,d=b*c,e=Math.floor(d),f=TWEEN.Interpolation.Utils.Linear;return 0>c?f(a[0],a[1],d):1<c?f(a[b],a[b-1],b-d):f(a[e],a[e+1>b?b:e+1],d-e)},Bezier:function(a,c){for(var b=0,d=a.length-1,e=Math.pow,f=TWEEN.Interpolation.Utils.Bernstein,g=0;d>=g;g++)b+=e(1-c,d-g)*e(c,g)*a[g]*f(d,g);return b},CatmullRom:function(a,c){var b=a.length-1,d=b*c,e=Math.floor(d),f=TWEEN.Interpolation.Utils.CatmullRom;return a[0]===a[b]?(0>c&&(e=Math.floor(d=b*(1+c))),f(a[(e-
1+b)%b],a[e],a[(e+1)%b],a[(e+2)%b],d-e)):0>c?a[0]-(f(a[0],a[0],a[1],a[1],-d)-a[0]):1<c?a[b]-(f(a[b],a[b],a[b-1],a[b-1],d-b)-a[b]):f(a[e?e-1:0],a[e],a[e+1>b?b:e+1],a[e+2>b?b:e+2],d-e)},Utils:{Linear:function(a,c,b){return(c-a)*b+a},Bernstein:function(a,c){var b=TWEEN.Interpolation.Utils.Factorial;return b(a)/b(c)/b(a-c)},Factorial:function(){var a=[1];return function(c){var b=1;if(a[c])return a[c];for(var d=c;1<d;d--)b*=d;return a[c]=b,b}}(),CatmullRom:function(a,c,b,d,e){a=.5*(b-a);d=.5*(d-c);var f=
e*e;return(2*c-2*b+a+d)*e*f+(-3*c+3*b-2*a-d)*f+a*e+c}}};(function(a){"function"==typeof define&&define.amd?define([],function(){return TWEEN}):"undefined"!=typeof module&&"object"==typeof exports?module.exports=TWEEN:void 0!==a&&(a.TWEEN=TWEEN)})(this);
!function(a,c){"object"==typeof exports&&"object"==typeof module?module.exports=c():"function"==typeof define&&define.amd?define([],c):"object"==typeof exports?exports.dat=c():a.dat=c()}(this,function(){return function(a){function c(d){if(b[d])return b[d].exports;var e=b[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,c),e.loaded=!0,e.exports}var b={};return c.m=a,c.c=b,c.p="",c(0)}([function(a,c,b){c.__esModule=!0;c["default"]=b(1);a.exports=c["default"]},function(a,c,b){c.__esModule=
!0;c["default"]={color:{Color:b(2),math:b(6),interpret:b(3)},controllers:{Controller:b(7),BooleanController:b(8),OptionController:b(10),StringController:b(11),NumberController:b(12),NumberControllerBox:b(13),NumberControllerSlider:b(14),FunctionController:b(15),ColorController:b(16)},dom:{dom:b(9)},gui:{GUI:b(17)},GUI:b(17)};a.exports=c["default"]},function(a,c,b){function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b,c){Object.defineProperty(a,b,{get:function(){return"RGB"===this.__state.space?
this.__state[b]:(p.recalculateRGB(this,b,c),this.__state[b])},set:function(a){"RGB"!==this.__state.space&&(p.recalculateRGB(this,b,c),this.__state.space="RGB");this.__state[b]=a}})}function f(a,b){Object.defineProperty(a,b,{get:function(){return"HSV"===this.__state.space?this.__state[b]:(p.recalculateHSV(this),this.__state[b])},set:function(a){"HSV"!==this.__state.space&&(p.recalculateHSV(this),this.__state.space="HSV");this.__state[b]=a}})}c.__esModule=!0;var g=b(3),h=d(g),g=b(6),k=d(g),g=b(4),m=
d(g);b=b(5);var w=d(b),p=function(){function a(){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");if(this.__state=h["default"].apply(this,arguments),!1===this.__state)throw Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return a.prototype.toString=function(){return m["default"](this)},a.prototype.toOriginal=function(){return this.__state.conversion.write(this)},a}();p.recalculateRGB=function(a,b,c){if("HEX"===a.__state.space)a.__state[b]=
k["default"].component_from_hex(a.__state.hex,c);else{if("HSV"!==a.__state.space)throw Error("Corrupted color state");w["default"].extend(a.__state,k["default"].hsv_to_rgb(a.__state.h,a.__state.s,a.__state.v))}};p.recalculateHSV=function(a){var b=k["default"].rgb_to_hsv(a.r,a.g,a.b);w["default"].extend(a.__state,{s:b.s,v:b.v});w["default"].isNaN(b.h)?w["default"].isUndefined(a.__state.h)&&(a.__state.h=0):a.__state.h=b.h};p.COMPONENTS="r g b h s v hex a".split(" ");e(p.prototype,"r",2);e(p.prototype,
"g",1);e(p.prototype,"b",0);f(p.prototype,"h");f(p.prototype,"s");f(p.prototype,"v");Object.defineProperty(p.prototype,"a",{get:function(){return this.__state.a},set:function(a){this.__state.a=a}});Object.defineProperty(p.prototype,"hex",{get:function(){return this.__state.hex=k["default"].rgb_to_hex(this.r,this.g,this.b),this.__state.hex},set:function(a){this.__state.space="HEX";this.__state.hex=a}});c["default"]=p;a.exports=c["default"]},function(a,c,b){c.__esModule=!0;var d=b(4),d=d&&d.__esModule?
d:{"default":d},e=(b=b(5))&&b.__esModule?b:{"default":b},f=[{litmus:e["default"].isString,conversions:{THREE_CHAR_HEX:{read:function(a){a=a.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==a&&{space:"HEX",hex:parseInt("0x"+a[1].toString()+a[1].toString()+a[2].toString()+a[2].toString()+a[3].toString()+a[3].toString(),0)}},write:d["default"]},SIX_CHAR_HEX:{read:function(a){a=a.match(/^#([A-F0-9]{6})$/i);return null!==a&&{space:"HEX",hex:parseInt("0x"+a[1].toString(),0)}},write:d["default"]},
CSS_RGB:{read:function(a){a=a.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==a&&{space:"RGB",r:parseFloat(a[1]),g:parseFloat(a[2]),b:parseFloat(a[3])}},write:d["default"]},CSS_RGBA:{read:function(a){a=a.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==a&&{space:"RGB",r:parseFloat(a[1]),g:parseFloat(a[2]),b:parseFloat(a[3]),a:parseFloat(a[4])}},write:d["default"]}}},{litmus:e["default"].isNumber,conversions:{HEX:{read:function(a){return{space:"HEX",hex:a,
conversionName:"HEX"}},write:function(a){return a.hex}}}},{litmus:e["default"].isArray,conversions:{RGB_ARRAY:{read:function(a){return 3===a.length&&{space:"RGB",r:a[0],g:a[1],b:a[2]}},write:function(a){return[a.r,a.g,a.b]}},RGBA_ARRAY:{read:function(a){return 4===a.length&&{space:"RGB",r:a[0],g:a[1],b:a[2],a:a[3]}},write:function(a){return[a.r,a.g,a.b,a.a]}}}},{litmus:e["default"].isObject,conversions:{RGBA_OBJ:{read:function(a){return!!(e["default"].isNumber(a.r)&&e["default"].isNumber(a.g)&&e["default"].isNumber(a.b)&&
e["default"].isNumber(a.a))&&{space:"RGB",r:a.r,g:a.g,b:a.b,a:a.a}},write:function(a){return{r:a.r,g:a.g,b:a.b,a:a.a}}},RGB_OBJ:{read:function(a){return!!(e["default"].isNumber(a.r)&&e["default"].isNumber(a.g)&&e["default"].isNumber(a.b))&&{space:"RGB",r:a.r,g:a.g,b:a.b}},write:function(a){return{r:a.r,g:a.g,b:a.b}}},HSVA_OBJ:{read:function(a){return!!(e["default"].isNumber(a.h)&&e["default"].isNumber(a.s)&&e["default"].isNumber(a.v)&&e["default"].isNumber(a.a))&&{space:"HSV",h:a.h,s:a.s,v:a.v,a:a.a}},
write:function(a){return{h:a.h,s:a.s,v:a.v,a:a.a}}},HSV_OBJ:{read:function(a){return!!(e["default"].isNumber(a.h)&&e["default"].isNumber(a.s)&&e["default"].isNumber(a.v))&&{space:"HSV",h:a.h,s:a.s,v:a.v}},write:function(a){return{h:a.h,s:a.s,v:a.v}}}}}],g=void 0,h=void 0;c["default"]=function(){h=!1;var a=1<arguments.length?e["default"].toArray(arguments):arguments[0];return e["default"].each(f,function(b){if(b.litmus(a))return e["default"].each(b.conversions,function(b,c){if(g=b.read(a),!1===h&&
!1!==g)return h=g,g.conversionName=c,g.conversion=b,e["default"].BREAK}),e["default"].BREAK}),h};a.exports=c["default"]},function(a,c,b){c.__esModule=!0;var d=(b=b(5))&&b.__esModule?b:{"default":b};c["default"]=function(a){if(1===a.a||d["default"].isUndefined(a.a)){for(a=a.hex.toString(16);6>a.length;)a="0"+a;return"#"+a}return"rgba("+Math.round(a.r)+","+Math.round(a.g)+","+Math.round(a.b)+","+a.a+")"};a.exports=c["default"]},function(a,c){c.__esModule=!0;var b=Array.prototype.forEach,d=Array.prototype.slice,
e={BREAK:{},extend:function(a){return this.each(d.call(arguments,1),function(b){this.isUndefined(b)||Object.keys(b).forEach(function(c){this.isUndefined(b[c])||(a[c]=b[c])}.bind(this))},this),a},defaults:function(a){return this.each(d.call(arguments,1),function(b){this.isUndefined(b)||Object.keys(b).forEach(function(c){this.isUndefined(a[c])&&(a[c]=b[c])}.bind(this))},this),a},compose:function(){var a=d.call(arguments);return function(){for(var b=d.call(arguments),c=a.length-1;0<=c;c--)b=[a[c].apply(this,
b)];return b[0]}},each:function(a,c,d){if(a)if(b&&a.forEach&&a.forEach===b)a.forEach(c,d);else if(a.length===a.length+0)for(var e=void 0,f=void 0,e=0,f=a.length;e<f&&!(e in a&&c.call(d,a[e],e)===this.BREAK);e++);else this.isUndefined(a)||Object.keys(a).forEach(function(b){c.call(d,a[b],b)===this.BREAK}.bind(this))},defer:function(a){setTimeout(a,0)},debounce:function(a,b){var c=void 0;return function(){var d=arguments,e=!c;clearTimeout(c);c=setTimeout(function(){c=null},b);e&&a.apply(this,d)}},toArray:function(a){return a.toArray?
a.toArray():d.call(a)},isUndefined:function(a){return void 0===a},isNull:function(a){return null===a},isNaN:function(a){function b(b){return a.apply(this,arguments)}return b.toString=function(){return a.toString()},b}(function(a){return isNaN(a)}),isArray:Array.isArray||function(a){return a.constructor===Array},isObject:function(a){return a===Object(a)},isNumber:function(a){return a===a+0},isString:function(a){return a===a+""},isBoolean:function(a){return!1===a||!0===a},isFunction:function(a){return"[object Function]"===
Object.prototype.toString.call(a)}};c["default"]=e;a.exports=c["default"]},function(a,c){c.__esModule=!0;var b=void 0;c["default"]={hsv_to_rgb:function(a,b,c){var d=a/60-Math.floor(a/60),e=c*(1-b),k=c*(1-d*b);b=c*(1-(1-d)*b);a=[[c,b,e],[k,c,e],[e,c,b],[e,k,c],[b,e,c],[c,e,k]][Math.floor(a/60)%6];return{r:255*a[0],g:255*a[1],b:255*a[2]}},rgb_to_hsv:function(a,b,c){var d=Math.max(a,b,c),e=d-Math.min(a,b,c),k=void 0,f=void 0;return 0===d?{h:NaN,s:0,v:0}:(f=e/d,k=a===d?(b-c)/e:b===d?2+(c-a)/e:4+(a-b)/
e,k/=6,0>k&&(k+=1),{h:360*k,s:f,v:d/255})},rgb_to_hex:function(a,b,c){a=this.hex_with_component(0,2,a);return a=this.hex_with_component(a,1,b),this.hex_with_component(a,0,c)},component_from_hex:function(a,b){return a>>8*b&255},hex_with_component:function(a,c,f){return f<<(b=8*c)|a&~(255<<b)}};a.exports=c["default"]},function(a,c){c.__esModule=!0;var b=function(){function a(b,c){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.initialValue=b[c];this.domElement=
document.createElement("div");this.object=b;this.property=c;this.__onFinishChange=this.__onChange=void 0}return a.prototype.onChange=function(a){return this.__onChange=a,this},a.prototype.onFinishChange=function(a){return this.__onFinishChange=a,this},a.prototype.setValue=function(a){return this.object[this.property]=a,this.__onChange&&this.__onChange.call(this,a),this.updateDisplay(),this},a.prototype.getValue=function(){return this.object[this.property]},a.prototype.updateDisplay=function(){return this},
a.prototype.isModified=function(){return this.initialValue!==this.getValue()},a}();c["default"]=b;a.exports=c["default"]},function(a,c,b){function d(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}c.__esModule=!0;var e=b(7),e=e&&e.__esModule?e:{"default":e},
f=(b=b(9))&&b.__esModule?b:{"default":b};b=function(a){function b(c,d){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");a.call(this,c,d);var e=this;this.__prev=this.getValue();this.__checkbox=document.createElement("input");this.__checkbox.setAttribute("type","checkbox");f["default"].bind(this.__checkbox,"change",function(){e.setValue(!e.__prev)},!1);this.domElement.appendChild(this.__checkbox);this.updateDisplay()}return d(b,a),b.prototype.setValue=function(b){b=a.prototype.setValue.call(this,
b);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),b},b.prototype.updateDisplay=function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0):this.__checkbox.checked=!1,a.prototype.updateDisplay.call(this)},b}(e["default"]);c["default"]=b;a.exports=c["default"]},function(a,c,b){function d(a){if("0"===a||e["default"].isUndefined(a))return 0;a=a.match(g);return e["default"].isNull(a)?0:
parseFloat(a[1])}c.__esModule=!0;var e=(b=b(5))&&b.__esModule?b:{"default":b},f={};e["default"].each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},function(a,b){e["default"].each(a,function(a){f[a]=b})});var g=/(\d+(\.\d+)?)px/,h={makeSelectable:function(a,b){void 0!==a&&void 0!==a.style&&(a.onselectstart=b?function(){return!1}:function(){},a.style.MozUserSelect=b?"auto":"none",a.style.KhtmlUserSelect=b?"auto":"none",a.unselectable=
b?"on":"off")},makeFullscreen:function(a,b,c){e["default"].isUndefined(b)&&(b=!0);e["default"].isUndefined(c)&&(c=!0);a.style.position="absolute";b&&(a.style.left=0,a.style.right=0);c&&(a.style.top=0,a.style.bottom=0)},fakeEvent:function(a,b,c,d){c=c||{};var h=f[b];if(!h)throw Error("Event type "+b+" not supported.");var k=document.createEvent(h);switch(h){case "MouseEvents":k.initMouseEvent(b,c.bubbles||!1,c.cancelable||!0,window,c.clickCount||1,0,0,c.x||c.clientX||0,c.y||c.clientY||0,!1,!1,!1,!1,
0,null);break;case "KeyboardEvents":h=k.initKeyboardEvent||k.initKeyEvent;e["default"].defaults(c,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0});h(b,c.bubbles||!1,c.cancelable,window,c.ctrlKey,c.altKey,c.shiftKey,c.metaKey,c.keyCode,c.charCode);break;default:k.initEvent(b,c.bubbles||!1,c.cancelable||!0)}e["default"].defaults(k,d);a.dispatchEvent(k)},bind:function(a,b,c,d){return a.addEventListener?a.addEventListener(b,c,d||!1):a.attachEvent&&a.attachEvent("on"+
b,c),h},unbind:function(a,b,c,d){return a.removeEventListener?a.removeEventListener(b,c,d||!1):a.detachEvent&&a.detachEvent("on"+b,c),h},addClass:function(a,b){if(void 0===a.className)a.className=b;else if(a.className!==b){var c=a.className.split(/ +/);-1===c.indexOf(b)&&(c.push(b),a.className=c.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return h},removeClass:function(a,b){if(b)if(a.className===b)a.removeAttribute("class");else{var c=a.className.split(/ +/),d=c.indexOf(b);-1!==d&&(c.splice(d,
1),a.className=c.join(" "))}else a.className=void 0;return h},hasClass:function(a,b){return(new RegExp("(?:^|\\s+)"+b+"(?:\\s+|$)")).test(a.className)||!1},getWidth:function(a){a=getComputedStyle(a);return d(a["border-left-width"])+d(a["border-right-width"])+d(a["padding-left"])+d(a["padding-right"])+d(a.width)},getHeight:function(a){a=getComputedStyle(a);return d(a["border-top-width"])+d(a["border-bottom-width"])+d(a["padding-top"])+d(a["padding-bottom"])+d(a.height)},getOffset:function(a){var b=
{left:0,top:0};if(a.offsetParent){do b.left+=a.offsetLeft,b.top+=a.offsetTop,a=a.offsetParent;while(a)}return b},isActive:function(a){return a===document.activeElement&&(a.type||a.href)}};c["default"]=h;a.exports=c["default"]},function(a,c,b){function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,
writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}c.__esModule=!0;var f=b(7),f=d(f),g=b(9),h=d(g);b=b(5);var k=d(b);b=function(a){function b(c,d,e){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");a.call(this,c,d);var f=e,g=this;this.__select=document.createElement("select");k["default"].isArray(f)&&!function(){var a={};k["default"].each(f,function(b){a[b]=b});f=a}();k["default"].each(f,function(a,b){var c=document.createElement("option");
c.innerHTML=b;c.setAttribute("value",a);g.__select.appendChild(c)});this.updateDisplay();h["default"].bind(this.__select,"change",function(){g.setValue(this.options[this.selectedIndex].value)});this.domElement.appendChild(this.__select)}return e(b,a),b.prototype.setValue=function(b){b=a.prototype.setValue.call(this,b);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),b},b.prototype.updateDisplay=function(){return h["default"].isActive(this.__select)?this:(this.__select.value=
this.getValue(),a.prototype.updateDisplay.call(this))},b}(f["default"]);c["default"]=b;a.exports=c["default"]},function(a,c,b){function d(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}c.__esModule=!0;var e=b(7),e=e&&e.__esModule?e:{"default":e},
f=(b=b(9))&&b.__esModule?b:{"default":b};b=function(a){function b(c,d){function e(){h.setValue(h.__input.value)}if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");a.call(this,c,d);var h=this;this.__input=document.createElement("input");this.__input.setAttribute("type","text");f["default"].bind(this.__input,"keyup",e);f["default"].bind(this.__input,"change",e);f["default"].bind(this.__input,"blur",function(){h.__onFinishChange&&h.__onFinishChange.call(h,h.getValue())});
f["default"].bind(this.__input,"keydown",function(a){13===a.keyCode&&this.blur()});this.updateDisplay();this.domElement.appendChild(this.__input)}return d(b,a),b.prototype.updateDisplay=function(){return f["default"].isActive(this.__input)||(this.__input.value=this.getValue()),a.prototype.updateDisplay.call(this)},b}(e["default"]);c["default"]=b;a.exports=c["default"]},function(a,c,b){function d(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+
typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function e(a){a=a.toString();return-1<a.indexOf(".")?a.length-a.indexOf(".")-1:0}c.__esModule=!0;var f=b(7),f=f&&f.__esModule?f:{"default":f},g=(b=b(5))&&b.__esModule?b:{"default":b};b=function(a){function b(c,d,f){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");a.call(this,c,d);c=
f||{};this.__min=c.min;this.__max=c.max;this.__step=c.step;g["default"].isUndefined(this.__step)?0===this.initialValue?this.__impliedStep=1:this.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(this.initialValue))/Math.LN10))/10:this.__impliedStep=this.__step;this.__precision=e(this.__impliedStep)}return d(b,a),b.prototype.setValue=function(b){return void 0!==this.__min&&b<this.__min?b=this.__min:void 0!==this.__max&&b>this.__max&&(b=this.__max),void 0!==this.__step&&0!==b%this.__step&&(b=Math.round(b/
this.__step)*this.__step),a.prototype.setValue.call(this,b)},b.prototype.min=function(a){return this.__min=a,this},b.prototype.max=function(a){return this.__max=a,this},b.prototype.step=function(a){return this.__step=a,this.__impliedStep=a,this.__precision=e(a),this},b}(f["default"]);c["default"]=b;a.exports=c["default"]},function(a,c,b){function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+
typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}c.__esModule=!0;var f=b(12),f=d(f),g=b(9),h=d(g);b=b(5);var k=d(b);b=function(a){function b(c,d,e){function f(){var a=parseFloat(n.__input.value);k["default"].isNaN(a)||n.setValue(a)}function g(a){document.activeElement.blur();var b=p-a.clientY;n.setValue(n.getValue()+b*n.__impliedStep);p=a.clientY}function m(){h["default"].unbind(window,
"mousemove",g);h["default"].unbind(window,"mouseup",m)}if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");a.call(this,c,d,e);this.__truncationSuspended=!1;var n=this,p=void 0;this.__input=document.createElement("input");this.__input.setAttribute("type","text");h["default"].bind(this.__input,"change",f);h["default"].bind(this.__input,"blur",function(){f();n.__onFinishChange&&n.__onFinishChange.call(n,n.getValue())});h["default"].bind(this.__input,"mousedown",function(a){h["default"].bind(window,
"mousemove",g);h["default"].bind(window,"mouseup",m);p=a.clientY});h["default"].bind(this.__input,"keydown",function(a){13===a.keyCode&&(n.__truncationSuspended=!0,this.blur(),n.__truncationSuspended=!1)});this.updateDisplay();this.domElement.appendChild(this.__input)}return e(b,a),b.prototype.updateDisplay=function(){var b;if(h["default"].isActive(this.__input))b=this;else{b=this.__input;var c;if(this.__truncationSuspended)c=this.getValue();else{c=this.getValue();var d=Math.pow(10,this.__precision);
c=Math.round(c*d)/d}b=(b.value=c,a.prototype.updateDisplay.call(this))}return b},b}(f["default"]);c["default"]=b;a.exports=c["default"]},function(a,c,b){function d(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function e(a,b,c,d,e){return d+(a-
b)/(c-b)*(e-d)}c.__esModule=!0;var f=b(12),f=f&&f.__esModule?f:{"default":f},g=(b=b(9))&&b.__esModule?b:{"default":b};b=function(a){function b(c,d,f,h,k){function m(a){a.preventDefault();var b=g["default"].getOffset(q.__background),c=g["default"].getWidth(q.__background);return q.setValue(e(a.clientX,b.left,b.left+c,q.__min,q.__max)),!1}function n(){g["default"].unbind(window,"mousemove",m);g["default"].unbind(window,"mouseup",n);q.__onFinishChange&&q.__onFinishChange.call(q,q.getValue())}if(!(this instanceof
b))throw new TypeError("Cannot call a class as a function");a.call(this,c,d,{min:f,max:h,step:k});var q=this;this.__background=document.createElement("div");this.__foreground=document.createElement("div");g["default"].bind(this.__background,"mousedown",function(a){document.activeElement.blur();g["default"].bind(window,"mousemove",m);g["default"].bind(window,"mouseup",n);m(a)});g["default"].addClass(this.__background,"slider");g["default"].addClass(this.__foreground,"slider-fg");this.updateDisplay();
this.__background.appendChild(this.__foreground);this.domElement.appendChild(this.__background)}return d(b,a),b.prototype.updateDisplay=function(){var b=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*b+"%",a.prototype.updateDisplay.call(this)},b}(f["default"]);c["default"]=b;a.exports=c["default"]},function(a,c,b){function d(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);
a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}c.__esModule=!0;var e=b(7),e=e&&e.__esModule?e:{"default":e},f=(b=b(9))&&b.__esModule?b:{"default":b};b=function(a){function b(c,d,e){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");a.call(this,c,d);var g=this;this.__button=document.createElement("div");this.__button.innerHTML=void 0===e?"Fire":
e;f["default"].bind(this.__button,"click",function(a){return a.preventDefault(),g.fire(),!1});f["default"].addClass(this.__button,"button");this.domElement.appendChild(this.__button)}return d(b,a),b.prototype.fire=function(){this.__onChange&&this.__onChange.call(this);this.getValue().call(this.object);this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())},b}(e["default"]);c["default"]=b;a.exports=c["default"]},function(a,c,b){function d(a){return a&&a.__esModule?a:{"default":a}}
function e(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function f(a,b,c,d){a.style.background="";n["default"].each(y,function(e){a.style.cssText+="background: "+e+"linear-gradient("+b+", "+c+" 0%, "+d+" 100%); "})}function g(a){a.style.background=
"";a.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);";a.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);";a.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);";a.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);";
a.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}c.__esModule=!0;var h=b(7),h=d(h),k=b(9),m=d(k),k=b(2),w=d(k),k=b(3),p=d(k);b=b(5);var n=d(b);b=function(a){function b(c,d){function e(a){v(a);m["default"].bind(window,"mousemove",v);m["default"].bind(window,"mouseup",h)}function h(){m["default"].unbind(window,"mousemove",v);m["default"].unbind(window,"mouseup",h);t()}function k(){var a=p["default"](this.value);
!1!==a?(u.__color.__state=a,u.setValue(u.__color.toOriginal())):this.value=u.__color.toString()}function q(){m["default"].unbind(window,"mousemove",y);m["default"].unbind(window,"mouseup",q);t()}function t(){u.__onFinishChange&&u.__onFinishChange.call(u,u.__color.toString())}function v(a){a.preventDefault();var b=m["default"].getWidth(u.__saturation_field),c=m["default"].getOffset(u.__saturation_field),d=(a.clientX-c.left+document.body.scrollLeft)/b;a=1-(a.clientY-c.top+document.body.scrollTop)/b;
return 1<a?a=1:0>a&&(a=0),1<d?d=1:0>d&&(d=0),u.__color.v=a,u.__color.s=d,u.setValue(u.__color.toOriginal()),!1}function y(a){a.preventDefault();var b=m["default"].getHeight(u.__hue_field),c=m["default"].getOffset(u.__hue_field);a=1-(a.clientY-c.top+document.body.scrollTop)/b;return 1<a?a=1:0>a&&(a=0),u.__color.h=360*a,u.setValue(u.__color.toOriginal()),!1}if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");a.call(this,c,d);this.__color=new w["default"](this.getValue());
this.__temp=new w["default"](0);var u=this;this.domElement=document.createElement("div");m["default"].makeSelectable(this.domElement,!1);this.__selector=document.createElement("div");this.__selector.className="selector";this.__saturation_field=document.createElement("div");this.__saturation_field.className="saturation-field";this.__field_knob=document.createElement("div");this.__field_knob.className="field-knob";this.__field_knob_border="2px solid ";this.__hue_knob=document.createElement("div");this.__hue_knob.className=
"hue-knob";this.__hue_field=document.createElement("div");this.__hue_field.className="hue-field";this.__input=document.createElement("input");this.__input.type="text";this.__input_textShadow="0 1px 1px ";m["default"].bind(this.__input,"keydown",function(a){13===a.keyCode&&k.call(this)});m["default"].bind(this.__input,"blur",k);m["default"].bind(this.__selector,"mousedown",function(){m["default"].addClass(this,"drag").bind(window,"mouseup",function(){m["default"].removeClass(u.__selector,"drag")})});
var l=document.createElement("div");n["default"].extend(this.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"});n["default"].extend(this.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:this.__field_knob_border+(.5>this.__color.v?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1});n["default"].extend(this.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",
borderRight:"4px solid #fff",zIndex:1});n["default"].extend(this.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"});n["default"].extend(l.style,{width:"100%",height:"100%",background:"none"});f(l,"top","rgba(0,0,0,0)","#000");n["default"].extend(this.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"});g(this.__hue_field);n["default"].extend(this.__input.style,
{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:this.__input_textShadow+"rgba(0,0,0,0.7)"});m["default"].bind(this.__saturation_field,"mousedown",e);m["default"].bind(this.__field_knob,"mousedown",e);m["default"].bind(this.__hue_field,"mousedown",function(a){y(a);m["default"].bind(window,"mousemove",y);m["default"].bind(window,"mouseup",q)});this.__saturation_field.appendChild(l);this.__selector.appendChild(this.__field_knob);this.__selector.appendChild(this.__saturation_field);
this.__selector.appendChild(this.__hue_field);this.__hue_field.appendChild(this.__hue_knob);this.domElement.appendChild(this.__input);this.domElement.appendChild(this.__selector);this.updateDisplay()}return e(b,a),b.prototype.updateDisplay=function(){var a=p["default"](this.getValue());if(!1!==a){var b=!1;n["default"].each(w["default"].COMPONENTS,function(c){if(!n["default"].isUndefined(a[c])&&!n["default"].isUndefined(this.__color.__state[c])&&a[c]!==this.__color.__state[c])return b=!0,{}},this);
b&&n["default"].extend(this.__color.__state,a)}n["default"].extend(this.__temp.__state,this.__color.__state);this.__temp.a=1;var c=.5>this.__color.v||.5<this.__color.s?255:0,d=255-c;n["default"].extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toString(),border:this.__field_knob_border+"rgb("+c+","+c+","+c+")"});this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px";this.__temp.s=1;this.__temp.v=1;f(this.__saturation_field,
"left","#fff",this.__temp.toString());n["default"].extend(this.__input.style,{backgroundColor:this.__input.value=this.__color.toString(),color:"rgb("+c+","+c+","+c+")",textShadow:this.__input_textShadow+"rgba("+d+","+d+","+d+",.7)"})},b}(h["default"]);var y=["-moz-","-o-","-webkit-","-ms-",""];c["default"]=b;a.exports=c["default"]},function(a,c,b){function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b,c){var d=document.createElement("li");return b&&d.appendChild(b),c?a.__ul.insertBefore(d,
c):a.__ul.appendChild(d),a.onResize(),d}function f(a,b){var c=a.__preset_select[a.__preset_select.selectedIndex];b?c.innerHTML=c.value+"*":c.innerHTML=c.value}function g(a,b,c){if(c.__li=b,c.__gui=a,r["default"].extend(c,{options:function(b){if(1<arguments.length){var d=c.__li.nextElementSibling;return c.remove(),k(a,c.object,c.property,{before:d,factoryArgs:[r["default"].toArray(arguments)]})}if(r["default"].isArray(b)||r["default"].isObject(b))return d=c.__li.nextElementSibling,c.remove(),k(a,c.object,
c.property,{before:d,factoryArgs:[b]})},name:function(a){return c.__li.firstElementChild.firstElementChild.innerHTML=a,c},listen:function(){return c.__gui.listen(c),c},remove:function(){return c.__gui.remove(c),c}}),c instanceof N["default"])!function(){var a=new J["default"](c.object,c.property,{min:c.__min,max:c.__max,step:c.__step});r["default"].each(["updateDisplay","onChange","onFinishChange","step"],function(b){var d=c[b],e=a[b];c[b]=a[b]=function(){var b=Array.prototype.slice.call(arguments);
return e.apply(a,b),d.apply(c,b)}});l["default"].addClass(b,"has-slider");c.domElement.insertBefore(a.domElement,c.domElement.firstElementChild)}();else if(c instanceof J["default"]){var d=function(b){return r["default"].isNumber(c.__min)&&r["default"].isNumber(c.__max)?(c.remove(),k(a,c.object,c.property,{before:c.__li.nextElementSibling,factoryArgs:[c.__min,c.__max,c.__step]})):b};c.min=r["default"].compose(d,c.min);c.max=r["default"].compose(d,c.max)}else c instanceof E["default"]?(l["default"].bind(b,
"click",function(){l["default"].fakeEvent(c.__checkbox,"click")}),l["default"].bind(c.__checkbox,"click",function(a){a.stopPropagation()})):c instanceof M["default"]?(l["default"].bind(b,"click",function(){l["default"].fakeEvent(c.__button,"click")}),l["default"].bind(b,"mouseover",function(){l["default"].addClass(c.__button,"hover")}),l["default"].bind(b,"mouseout",function(){l["default"].removeClass(c.__button,"hover")})):c instanceof C["default"]&&(l["default"].addClass(b,"color"),c.updateDisplay=
r["default"].compose(function(a){return b.style.borderLeftColor=c.__color.toString(),a},c.updateDisplay),c.updateDisplay());c.setValue=r["default"].compose(function(b){return a.getRoot().__preset_select&&c.isModified()&&f(a.getRoot(),!0),b},c.setValue)}function h(a,b){var c=a.getRoot(),d=c.__rememberedObjects.indexOf(b.object);if(-1!==d){var e=c.__rememberedObjectIndecesToControllers[d];if(void 0===e&&(e={},c.__rememberedObjectIndecesToControllers[d]=e),e[b.property]=b,c.load&&c.load.remembered){c=
c.load.remembered;if(c[a.preset])c=c[a.preset];else{if(!c[G])return;c=c[G]}c[d]&&void 0!==c[d][b.property]&&(d=c[d][b.property],b.initialValue=d,b.setValue(d))}}}function k(a,b,c,d){if(void 0===b[c])throw Error('Object "'+b+'" has no property "'+c+'"');d.color?b=new C["default"](b,c):(b=[b,c].concat(d.factoryArgs),b=v["default"].apply(a,b));d.before instanceof z["default"]&&(d.before=d.before.__li);h(a,b);l["default"].addClass(b.domElement,"c");c=document.createElement("span");l["default"].addClass(c,
"property-name");c.innerHTML=b.property;var f=document.createElement("div");f.appendChild(c);f.appendChild(b.domElement);d=e(a,f,d.before);return l["default"].addClass(d,x.CLASS_CONTROLLER_ROW),b instanceof C["default"]?l["default"].addClass(d,"color"):l["default"].addClass(d,typeof b.getValue()),g(a,d,b),a.__controllers.push(b),b}function m(a,b,c){var d=document.createElement("option");d.innerHTML=b;d.value=b;a.__preset_select.appendChild(d);c&&(a.__preset_select.selectedIndex=a.__preset_select.length-
1)}function w(a){var b=a.__save_row=document.createElement("li");l["default"].addClass(a.domElement,"has-save");a.__ul.insertBefore(b,a.__ul.firstChild);l["default"].addClass(b,"save-row");var c=document.createElement("span");c.innerHTML="&nbsp;";l["default"].addClass(c,"button gears");var d=document.createElement("span");d.innerHTML="Save";l["default"].addClass(d,"button");l["default"].addClass(d,"save");var e=document.createElement("span");e.innerHTML="New";l["default"].addClass(e,"button");l["default"].addClass(e,
"save-as");var f=document.createElement("span");f.innerHTML="Revert";l["default"].addClass(f,"button");l["default"].addClass(f,"revert");var h=a.__preset_select=document.createElement("select");a.load&&a.load.remembered?r["default"].each(a.load.remembered,function(b,c){m(a,c,c===a.preset)}):m(a,G,!1);l["default"].bind(h,"change",function(){for(var b=0;b<a.__preset_select.length;b++)a.__preset_select[b].innerHTML=a.__preset_select[b].value;a.preset=this.value});b.appendChild(h);b.appendChild(c);b.appendChild(d);
b.appendChild(e);b.appendChild(f);D&&!function(){var b=document.getElementById("dg-local-explain"),c=document.getElementById("dg-local-storage");document.getElementById("dg-save-locally").style.display="block";"true"===localStorage.getItem(document.location.href+".isLocal")&&c.setAttribute("checked","checked");b.style.display=a.useLocalStorage?"block":"none";l["default"].bind(c,"change",function(){a.useLocalStorage=!a.useLocalStorage;b.style.display=a.useLocalStorage?"block":"none"})}();var g=document.getElementById("dg-new-constructor");
l["default"].bind(g,"keydown",function(a){!a.metaKey||67!==a.which&&67!==a.keyCode||H.hide()});l["default"].bind(c,"click",function(){g.innerHTML=JSON.stringify(a.getSaveObject(),void 0,2);H.show();g.focus();g.select()});l["default"].bind(d,"click",function(){a.save()});l["default"].bind(e,"click",function(){var b=prompt("Enter a new preset name.");b&&a.saveAs(b)});l["default"].bind(f,"click",function(){a.revert()})}function p(a){function b(b){return b.preventDefault(),a.width+=e-b.clientX,a.onResize(),
e=b.clientX,!1}function c(){l["default"].removeClass(a.__closeButton,x.CLASS_DRAG);l["default"].unbind(window,"mousemove",b);l["default"].unbind(window,"mouseup",c)}function d(d){return d.preventDefault(),e=d.clientX,l["default"].addClass(a.__closeButton,x.CLASS_DRAG),l["default"].bind(window,"mousemove",b),l["default"].bind(window,"mouseup",c),!1}var e=void 0;a.__resize_handle=document.createElement("div");r["default"].extend(a.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",
cursor:"ew-resize",position:"absolute"});l["default"].bind(a.__resize_handle,"mousedown",d);l["default"].bind(a.__closeButton,"mousedown",d);a.domElement.insertBefore(a.__resize_handle,a.domElement.firstElementChild)}function n(a,b){a.domElement.style.width=b+"px";a.__save_row&&a.autoPlace&&(a.__save_row.style.width=b+"px");a.__closeButton&&(a.__closeButton.style.width=b+"px")}function y(a,b){var c={};return r["default"].each(a.__rememberedObjects,function(d,e){var f={};r["default"].each(a.__rememberedObjectIndecesToControllers[e],
function(a,c){f[c]=b?a.initialValue:a.getValue()});c[e]=f}),c}function u(a){0!==a.length&&A["default"].call(window,function(){u(a)});r["default"].each(a,function(a){a.updateDisplay()})}c=b(18);c=d(c);var t=b(19),q=d(t),t=b(20),v=d(t),t=b(7),z=d(t),t=b(8),E=d(t),t=b(15),M=d(t),t=b(13),J=d(t),t=b(14),N=d(t),t=b(16),C=d(t),t=b(21),A=d(t),t=b(22),O=d(t),t=b(9),l=d(t),t=b(5),r=d(t);b=b(23);b=d(b);c["default"].inject(b["default"]);var G="Default",D;try{D="localStorage"in window&&null!==window.localStorage}catch(P){D=
!1}var H=void 0,K=!0,F=void 0,I=!1,L=[],x=function B(a){function b(){var a=c.getRoot();a.width+=1;r["default"].defer(function(){--a.width})}var c=this,d=a||{};this.domElement=document.createElement("div");this.__ul=document.createElement("ul");this.domElement.appendChild(this.__ul);l["default"].addClass(this.domElement,"dg");this.__folders={};this.__controllers=[];this.__rememberedObjects=[];this.__rememberedObjectIndecesToControllers=[];this.__listening=[];d=r["default"].defaults(d,{autoPlace:!0,
width:B.DEFAULT_WIDTH});d=r["default"].defaults(d,{resizable:d.autoPlace,hideable:d.autoPlace});r["default"].isUndefined(d.load)?d.load={preset:G}:d.preset&&(d.load.preset=d.preset);r["default"].isUndefined(d.parent)&&d.hideable&&L.push(this);d.resizable=r["default"].isUndefined(d.parent)&&d.resizable;d.autoPlace&&r["default"].isUndefined(d.scrollable)&&(d.scrollable=!0);var f=D&&"true"===localStorage.getItem(document.location.href+".isLocal"),g=void 0;if(Object.defineProperties(this,{parent:{get:function(){return d.parent}},
scrollable:{get:function(){return d.scrollable}},autoPlace:{get:function(){return d.autoPlace}},preset:{get:function(){return c.parent?c.getRoot().preset:d.load.preset},set:function(a){c.parent?c.getRoot().preset=a:d.load.preset=a;for(a=0;a<this.__preset_select.length;a++)this.__preset_select[a].value===this.preset&&(this.__preset_select.selectedIndex=a);c.revert()}},width:{get:function(){return d.width},set:function(a){d.width=a;n(c,a)}},name:{get:function(){return d.name},set:function(a){d.name=
a;titleRowName&&(titleRowName.innerHTML=d.name)}},closed:{get:function(){return d.closed},set:function(a){d.closed=a;d.closed?l["default"].addClass(c.__ul,B.CLASS_CLOSED):l["default"].removeClass(c.__ul,B.CLASS_CLOSED);this.onResize();c.__closeButton&&(c.__closeButton.innerHTML=a?B.TEXT_OPEN:B.TEXT_CLOSED)}},load:{get:function(){return d.load}},useLocalStorage:{get:function(){return f},set:function(a){D&&(f=a,a?l["default"].bind(window,"unload",g):l["default"].unbind(window,"unload",g),localStorage.setItem(document.location.href+
".isLocal",a))}}}),r["default"].isUndefined(d.parent)){if(d.closed=!1,l["default"].addClass(this.domElement,B.CLASS_MAIN),l["default"].makeSelectable(this.domElement,!1),D&&f)c.useLocalStorage=!0,(a=localStorage.getItem(document.location.href+".gui"))&&(d.load=JSON.parse(a));this.__closeButton=document.createElement("div");this.__closeButton.innerHTML=B.TEXT_CLOSED;l["default"].addClass(this.__closeButton,B.CLASS_CLOSE_BUTTON);this.domElement.appendChild(this.__closeButton);l["default"].bind(this.__closeButton,
"click",function(){c.closed=!c.closed})}else void 0===d.closed&&(d.closed=!0),a=document.createTextNode(d.name),l["default"].addClass(a,"controller-name"),a=e(c,a),l["default"].addClass(this.__ul,B.CLASS_CLOSED),l["default"].addClass(a,"title"),l["default"].bind(a,"click",function(a){return a.preventDefault(),c.closed=!c.closed,!1}),d.closed||(this.closed=!1);d.autoPlace&&(r["default"].isUndefined(d.parent)&&(K&&(F=document.createElement("div"),l["default"].addClass(F,"dg"),l["default"].addClass(F,
B.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(F),K=!1),F.appendChild(this.domElement),l["default"].addClass(this.domElement,B.CLASS_AUTO_PLACE)),this.parent||n(c,d.width));this.__resizeHandler=function(){c.onResize()};l["default"].bind(window,"resize",this.__resizeHandler);l["default"].bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler);l["default"].bind(this.__ul,"transitionend",this.__resizeHandler);l["default"].bind(this.__ul,"oTransitionEnd",this.__resizeHandler);this.onResize();
d.resizable&&p(this);this.saveToLocalStorageIfPossible=g=function(){D&&"true"===localStorage.getItem(document.location.href+".isLocal")&&localStorage.setItem(document.location.href+".gui",JSON.stringify(c.getSaveObject()))};d.parent||b()};x.toggleHide=function(){I=!I;r["default"].each(L,function(a){a.domElement.style.display=I?"none":""})};x.CLASS_AUTO_PLACE="a";x.CLASS_AUTO_PLACE_CONTAINER="ac";x.CLASS_MAIN="main";x.CLASS_CONTROLLER_ROW="cr";x.CLASS_TOO_TALL="taller-than-window";x.CLASS_CLOSED="closed";
x.CLASS_CLOSE_BUTTON="close-button";x.CLASS_DRAG="drag";x.DEFAULT_WIDTH=245;x.TEXT_CLOSED="Close Controls";x.TEXT_OPEN="Open Controls";x._keydownHandler=function(a){"text"===document.activeElement.type||72!==a.which&&72!==a.keyCode||x.toggleHide()};l["default"].bind(window,"keydown",x._keydownHandler,!1);r["default"].extend(x.prototype,{add:function(a,b){return k(this,a,b,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(a,b){return k(this,a,b,{color:!0})},remove:function(a){this.__ul.removeChild(a.__li);
this.__controllers.splice(this.__controllers.indexOf(a),1);var b=this;r["default"].defer(function(){b.onResize()})},destroy:function(){this.autoPlace&&F.removeChild(this.domElement);l["default"].unbind(window,"keydown",x._keydownHandler,!1);l["default"].unbind(window,"resize",this.__resizeHandler);this.saveToLocalStorageIfPossible&&l["default"].unbind(window,"unload",this.saveToLocalStorageIfPossible)},addFolder:function(a){if(void 0!==this.__folders[a])throw Error('You already have a folder in this GUI by the name "'+
a+'"');var b={name:a,parent:this};b.autoPlace=this.autoPlace;this.load&&this.load.folders&&this.load.folders[a]&&(b.closed=this.load.folders[a].closed,b.load=this.load.folders[a]);b=new x(b);this.__folders[a]=b;a=e(this,b.domElement);return l["default"].addClass(a,"folder"),b},open:function(){this.closed=!1},close:function(){this.closed=!0},onResize:r["default"].debounce(function(){var a=this.getRoot();if(a.scrollable){var b=l["default"].getOffset(a.__ul).top,c=0;r["default"].each(a.__ul.childNodes,
function(b){a.autoPlace&&b===a.__save_row||(c+=l["default"].getHeight(b))});window.innerHeight-b-20<c?(l["default"].addClass(a.domElement,x.CLASS_TOO_TALL),a.__ul.style.height=window.innerHeight-b-20+"px"):(l["default"].removeClass(a.domElement,x.CLASS_TOO_TALL),a.__ul.style.height="auto")}a.__resize_handle&&r["default"].defer(function(){a.__resize_handle.style.height=a.__ul.offsetHeight+"px"});a.__closeButton&&(a.__closeButton.style.width=a.width+"px")},200),remember:function(){if(r["default"].isUndefined(H)&&
(H=new O["default"],H.domElement.innerHTML=q["default"]),this.parent)throw Error("You can only call remember on a top level GUI.");var a=this;r["default"].each(Array.prototype.slice.call(arguments),function(b){0===a.__rememberedObjects.length&&w(a);-1===a.__rememberedObjects.indexOf(b)&&a.__rememberedObjects.push(b)});this.autoPlace&&n(this,this.width)},getRoot:function(){for(var a=this;a.parent;)a=a.parent;return a},getSaveObject:function(){var a=this.load;return a.closed=this.closed,0<this.__rememberedObjects.length&&
(a.preset=this.preset,a.remembered||(a.remembered={}),a.remembered[this.preset]=y(this)),a.folders={},r["default"].each(this.__folders,function(b,c){a.folders[c]=b.getSaveObject()}),a},save:function(){this.load.remembered||(this.load.remembered={});this.load.remembered[this.preset]=y(this);f(this,!1);this.saveToLocalStorageIfPossible()},saveAs:function(a){this.load.remembered||(this.load.remembered={},this.load.remembered[G]=y(this,!0));this.load.remembered[a]=y(this);this.preset=a;m(this,a,!0);this.saveToLocalStorageIfPossible()},
revert:function(a){r["default"].each(this.__controllers,function(b){this.getRoot().load.remembered?h(a||this.getRoot(),b):b.setValue(b.initialValue);b.__onFinishChange&&b.__onFinishChange.call(b,b.getValue())},this);r["default"].each(this.__folders,function(a){a.revert(a)});a||f(this.getRoot(),!1)},listen:function(a){var b=0===this.__listening.length;this.__listening.push(a);b&&u(this.__listening)},updateDisplay:function(){r["default"].each(this.__controllers,function(a){a.updateDisplay()});r["default"].each(this.__folders,
function(a){a.updateDisplay()})}});a.exports=x},function(a,c){a.exports={load:function(a,c){var b=c||document,d=b.createElement("link");d.type="text/css";d.rel="stylesheet";d.href=a;b.getElementsByTagName("head")[0].appendChild(d)},inject:function(a,c){var b=c||document,d=document.createElement("style");d.type="text/css";d.innerHTML=a;b=b.getElementsByTagName("head")[0];try{b.appendChild(d)}catch(g){}}}},function(a,c){a.exports='<div id=dg-save class="dg dialogue">Here\'s the new load parameter for your <code>GUI</code>\'s constructor:<textarea id=dg-new-constructor></textarea><div id=dg-save-locally><input id=dg-local-storage type="checkbox"> Automatically save values to <code>localStorage</code> on exit.<div id=dg-local-explain>The values saved to <code>localStorage</code> will override those passed to <code>dat.GUI</code>\'s constructor. This makes it easier to work incrementally, but <code>localStorage</code> is fragile, and your friends may not see the same values you do.</div></div></div>'},
function(a,c,b){function d(a){return a&&a.__esModule?a:{"default":a}}c.__esModule=!0;var e=b(10),f=d(e),e=b(13),g=d(e),e=b(14),h=d(e),e=b(11),k=d(e),e=b(15),m=d(e),e=b(8),w=d(e);b=b(5);var p=d(b);c["default"]=function(a,b,c,d,e){var n=a[b];return p["default"].isArray(c)||p["default"].isObject(c)?new f["default"](a,b,c):p["default"].isNumber(n)?p["default"].isNumber(c)&&p["default"].isNumber(d)?p["default"].isNumber(e)?new h["default"](a,b,c,d,e):new h["default"](a,b,c,d):p["default"].isNumber(e)?
new g["default"](a,b,{min:c,max:d,step:e}):new g["default"](a,b,{min:c,max:d}):p["default"].isString(n)?new k["default"](a,b):p["default"].isFunction(n)?new m["default"](a,b,""):p["default"].isBoolean(n)?new w["default"](a,b):null};a.exports=c["default"]},function(a,c){function b(a){setTimeout(a,1E3/60)}c.__esModule=!0;c["default"]=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||b;a.exports=
c["default"]},function(a,c,b){c.__esModule=!0;var d=b(9),e=d&&d.__esModule?d:{"default":d},f=(b=b(5))&&b.__esModule?b:{"default":b};b=function(){function a(){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.backgroundElement=document.createElement("div");f["default"].extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"});
e["default"].makeFullscreen(this.backgroundElement);this.backgroundElement.style.position="fixed";this.domElement=document.createElement("div");f["default"].extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"});document.body.appendChild(this.backgroundElement);document.body.appendChild(this.domElement);var b=this;e["default"].bind(this.backgroundElement,
"click",function(){b.hide()})}return a.prototype.show=function(){var a=this;this.backgroundElement.style.display="block";this.domElement.style.display="block";this.domElement.style.opacity=0;this.domElement.style.webkitTransform="scale(1.1)";this.layout();f["default"].defer(function(){a.backgroundElement.style.opacity=1;a.domElement.style.opacity=1;a.domElement.style.webkitTransform="scale(1)"})},a.prototype.hide=function(){var a=this,b=function w(){a.domElement.style.display="none";a.backgroundElement.style.display=
"none";e["default"].unbind(a.domElement,"webkitTransitionEnd",w);e["default"].unbind(a.domElement,"transitionend",w);e["default"].unbind(a.domElement,"oTransitionEnd",w)};e["default"].bind(this.domElement,"webkitTransitionEnd",b);e["default"].bind(this.domElement,"transitionend",b);e["default"].bind(this.domElement,"oTransitionEnd",b);this.backgroundElement.style.opacity=0;this.domElement.style.opacity=0;this.domElement.style.webkitTransform="scale(1.1)"},a.prototype.layout=function(){this.domElement.style.left=
window.innerWidth/2-e["default"].getWidth(this.domElement)/2+"px";this.domElement.style.top=window.innerHeight/2-e["default"].getHeight(this.domElement)/2+"px"},a}();c["default"]=b;a.exports=c["default"]},function(a,c,b){c=a.exports=b(24)();c.push([a.id,".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1!important}.dg.main .close-button.drag,.dg.main:hover .close-button{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;transition:opacity .1s linear;border:0;position:absolute;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-x:hidden}.dg.a.has-save>ul{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{position:fixed;top:0;z-index:1002}.dg li{-webkit-transition:height .1s ease-out;transition:height .1s ease-out}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;overflow:hidden;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid transparent}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:9px}.dg .c select{margin-top:5px}.dg .cr.boolean,.dg .cr.boolean *,.dg .cr.function,.dg .cr.function *,.dg .cr.function .property-name{cursor:pointer}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco,monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:9pt 0;display:block;width:440px;overflow-y:scroll;height:75pt;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande',sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:81pt}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:1pc;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid hsla(0,0%,100%,.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2fa1d6}.dg .cr.number input[type=text]{color:#2fa1d6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.boolean:hover,.dg .cr.function:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:0}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2fa1d6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}",
""])},function(a,c){a.exports=function(){var a=[];return a.toString=function(){for(var a=[],b=0;b<this.length;b++){var c=this[b];c[2]?a.push("@media "+c[2]+"{"+c[1]+"}"):a.push(c[1])}return a.join("")},a.i=function(b,c){"string"==typeof b&&(b=[[null,b,""]]);for(var d={},e=0;e<this.length;e++){var h=this[e][0];"number"==typeof h&&(d[h]=!0)}for(e=0;e<b.length;e++)h=b[e],"number"==typeof h[0]&&d[h[0]]||(c&&!h[2]?h[2]=c:c&&(h[2]="("+h[2]+") and ("+c+")"),a.push(h))},a}}])});
var PI=Math.PI,TWO_PI=2*PI,HALF_PI=PI/2,MODE_MENU=0,MODE_ENDLESS=1,MODE_SCORECARD=2;
function PuzzleGame(){this.renderer=new THREE.WebGLRenderer({antialias:!1,alpha:!0});this.renderer.setClearColor(0,0);this.windowWidth=Math.max(document.documentElement.clientWidth,window.innerWidth||0);this.windowHeight=Math.max(document.documentElement.clientHeight,window.innerHeight||0);this.renderer.setPixelRatio(window.devicePixelRatio);this.renderer.setSize(this.windowWidth,this.windowHeight);document.body.appendChild(this.renderer.domElement);this.scene=new THREE.Scene;this.camera=new THREE.PerspectiveCamera(75,
window.innerWidth/window.innerHeight,100,850);this.camera.position.z=500;this.resetGameVariables();this.difficultyTimeoutObj=this.pushTimeoutObj=null;this.initLoaders();this.tube=this.generateTube();this.scene.add(this.tube);this.scene.add(this.generateCylinderDepthFilter())}
PuzzleGame.prototype.preloadComplete=function(){this.gameBoard=new THREE.Object3D;this.nextRow=new THREE.Object3D;this.cursorObj=new THREE.Object3D;this.makeMenuText();this.closeAndSetGameMode(MODE_MENU);this.stats=new Stats;document.body.appendChild(this.stats.dom);this.debugMapNumber=1;window.addEventListener("resize",this.onWindowResize.bind(this),!1);document.addEventListener("keydown",this.keyPress.bind(this));this.initTouch();this.initDatGui();this.animate()};
PuzzleGame.prototype.closeAndSetGameMode=function(a){this.closeTube(this.setGameMode.bind(this,a))};
PuzzleGame.prototype.setGameMode=function(a){this.menuObj.visible=!1;this.menuLogo.visible=!1;this.menuScore.visible=!1;this.gameBoard.visible=!1;this.cursorObj.visible=!1;this.nextRow.visible=!1;this.gameMode=a;switch(a){case MODE_MENU:this.menuSelection=0;this.menuOptions=["Play Endless","Options","Credits"];this.menuObj.visible=!0;this.menuLogo.visible=!0;this.openTube();setTimeout(this.closeAndSetGameMode.bind(this,MODE_ENDLESS),2E3);break;case MODE_ENDLESS:this.gameBoard.visible=!0;this.cursorObj.visible=
!0;this.nextRow.visible=!0;this.resetGame();this.openTube();break;case MODE_SCORECARD:this.menuObj.visible=!0,this.menuLogo.visible=!0,this.menuScore.visible=!0,this.setScoreCardText(),this.openTube()}};
PuzzleGame.prototype.setScoreCardText=function(){var a=new THREE.TextGeometry("Score: "+this.score,{font:this.font,size:20,height:2}),c=new THREE.MeshBasicMaterial({color:this.blockColors.heart}),c=new THREE.Mesh(a,c);a.computeBoundingBox();c.position.x=-(a.boundingBox.max.x-a.boundingBox.min.x)/2;sThis=this;this.menuScore.traverseVisible(function(a){sThis.menuScore.remove(a)});this.menuScore.add(c)};
PuzzleGame.prototype.makeMenuText=function(){this.menuObj=new THREE.Group;this.menuOptionsObj=new THREE.Group;this.menuLogo=new THREE.Group;this.menuScore=new THREE.Group;var a=new THREE.TextGeometry("Puzzle",{font:this.font,size:40,height:2}),c=new THREE.TextGeometry("Cylinder",{font:this.font,size:40,height:2}),b=new THREE.MeshBasicMaterial({color:this.blockColors.diamond});this.title1=new THREE.Mesh(a,b);this.title2=new THREE.Mesh(c,b);a.computeBoundingBox();this.title1.position.x=-(a.boundingBox.max.x-
a.boundingBox.min.x)/2;c.computeBoundingBox();this.title2.position.x=-(c.boundingBox.max.x-c.boundingBox.min.x)/2;this.title1.position.y=30;this.title2.position.y=-30;this.menuLogo.add(this.title1);this.menuLogo.add(this.title2);this.menuLogo.position.y=100;this.menuObj.add(this.menuLogo);this.menuObj.add(this.menuScore);this.menuObj.position.z=15;this.scene.add(this.menuObj)};
PuzzleGame.prototype.makeHarder=function(){0<this.pushDelay&&(this.pushDelay=100-this.matches/5,0>this.pushDelay&&(this.pushDelay=0),90>=this.pushDelay&&(this.handicap=3),70>=this.pushDelay&&(this.handicap=2),50>=this.pushDelay&&(this.handicap=1),30>=this.pushDelay&&(this.handicap=0))};
PuzzleGame.prototype.initLoaders=function(){var a=document.getElementById("loader"),c=document.getElementById("loaderText"),b=new THREE.LoadingManager;console.log("New LoadingManager");var d=this;b.onLoad=function(){console.log("Loading complete!");d.preloadComplete();a.className="hideLoader";setTimeout(function(){a.className="hideLoaderDisplayNone"},1E3)};b.onProgress=function(a,b,d){console.log("Loading file: "+a+".\nLoaded "+b+" of "+d+" files.");c.innerHTML=Math.floor(b/d*100)};b.onError=function(a){console.log("There was an error loading "+
a)};this.fileLoader=new THREE.FileLoader(b);var e=new THREE.TextureLoader(b),b=new THREE.FontLoader(b);this.blankTexture=e.load("img/block.png");this.explodeTexture=e.load("img/block_explode.png");this.lockTexture=e.load("img/block_locked.png");this.tubeTexture=e.load("img/block.png");this.tubeTexture.wrapS=THREE.RepeatWrapping;this.tubeTexture.wrapT=THREE.RepeatWrapping;this.tubeTexture.repeat.set(this.boardWidth,this.boardHeight);b.load("fonts/Righteous_Regular.json",function(a){d.font=a});this.cursorTexture=
e.load("img/cursor.png");this.cursorTexture.magFilter=THREE.NearestFilter;this.cursorTexture.minFilter=THREE.NearestFilter;this.blockTextures={circle:e.load("img/block_circle.png"),diamond:e.load("img/block_diamond.png"),heart:e.load("img/block_heart.png"),star:e.load("img/block_star.png"),triangle:e.load("img/block_triangle.png"),triangle2:e.load("img/block_triangle2.png"),penta:e.load("img/block_penta.png")};this.blockColors={circle:5025616,diamond:10233776,heart:16007990,star:16771899,triangle:48340,
triangle2:4149685,penta:6323595}};
PuzzleGame.prototype.resetGameVariables=function(){this.score=this.animationQueue=0;this.gameGrid=[];this.boardHeight=13;this.boardWidth=30;this.circlePieceSize=TWO_PI/this.boardWidth;this.stackHeights=[];this.blockHeight=this.blockWidth=35;this.blockDepth=10;this.boardPixelHeight=this.boardHeight*this.blockHeight;this.halfBoardPixelHeight=this.boardPixelHeight/2;this.boardRadius=(this.blockWidth-1)*this.boardWidth/(2*PI);this.gameActive=this.hasControl=!1;this.upOffset=0;this.pushDelay=100;this.dropDelay=
150;this.handicap=4;this.piTimer=this.rowsCreated=this.matches=0;this.debugSelection=!1;this.chainCount=0;this.chainTimer=null};PuzzleGame.prototype.startGame=function(){this.closeAndSetGameMode(MODE_ENDLESS)};
PuzzleGame.prototype.resetGame=function(){TWEEN.removeAll();this.resetGameVariables();this.hasOwnProperty("gameBoard")&&this.scene.remove(this.gameBoard);this.gameBoard=this.cylinder();this.scene.add(this.gameBoard);this.generateNextRow();null!==this.pushTimeoutObj&&clearTimeout(this.pushTimeoutObj);this.pushTimeoutObj=setTimeout(this.checkToPushBlocks.bind(this),2E3);null!==this.difficultyTimeoutObj&&clearInterval(this.difficultyTimeoutObj);this.difficultyTimeoutObj=setInterval(this.makeHarder.bind(this),
1E3);this.hasOwnProperty("cursorObj")&&this.scene.remove(this.cursorObj);this.cursorObj=this.generateCursor();this.scene.add(this.cursorObj);this.selectorY=Math.floor(this.boardHeight/2);this.selectorX=0;var a=this.circlePieceSize*this.selectorX-HALF_PI-this.circlePieceSize/2;this.gameBoard.rotation.y=a-PI;this.nextRow.rotation.y=a;var c=this.updateTowerPos();this.gameBoard.position.y=c-this.boardPixelHeight;this.openTube();(new TWEEN.Tween(this.gameBoard.position)).to({y:c},1200).easing(TWEEN.Easing.Quintic.Out).delay(400).start();
var b=this;(new TWEEN.Tween(this.gameBoard.rotation)).to({y:a},1200).easing(TWEEN.Easing.Quintic.Out).delay(400).start().onComplete(function(){b.hasControl=!0;b.gameActive=!0;b.checkForMatches()})};
PuzzleGame.prototype.loseAnimation=function(){for(var a=0;a<this.boardWidth;a++)for(var c=0;c<this.boardHeight;c++)if(null!=this.gameGrid[a][c]){this.gameGrid[a][c].material.map=this.blankTexture;var b=500;null!=this.gameGrid[a][this.boardHeight-1]&&(b=2E3);(new TWEEN.Tween(this.gameGrid[a][c].position)).to({y:2*-this.boardPixelHeight},4E3).easing(TWEEN.Easing.Exponential.Out).delay(b).start()}setTimeout(this.closeAndSetGameMode.bind(this,MODE_SCORECARD),2500)};
PuzzleGame.prototype.checkToPushBlocks=function(){if(0===this.animationQueue){for(var a=0;a<this.boardWidth;a++)if(null!==this.gameGrid[a][this.boardHeight-1]){this.gameActive=this.hasControl=!1;this.loseAnimation();return}this.pushTowerUp()}this.pushTimeoutObj=setTimeout(this.checkToPushBlocks.bind(this),this.pushDelay)};
PuzzleGame.prototype.pushTowerUp=function(){this.upOffset+=this.blockHeight/100;if(this.upOffset>this.blockHeight){for(var a=0;a<this.boardWidth;a++)for(var c=this.boardHeight-1;0<=c;c--)null!=this.gameGrid[a][c]&&(this.gameGrid[a][c].position.y=this.calcYBlockPos(c+1),this.gameGrid[a][c+1]=this.gameGrid[a][c]);for(a=0;a<this.boardWidth;a++)c=this.generateBlockMesh(this.nextRow.children[a].userData.blockType,a,0),this.gameBoard.add(c),this.gameGrid[a][0]=c;this.checkForMatches();this.generateNextRow();
this.upOffset=0;this.selectorY++}this.updateTowerPos();this.updateCursorPos();this.updateNextRowPos()};
PuzzleGame.prototype.generateCursor=function(){var a=new THREE.Object3D,c=new THREE.PlaneGeometry(this.blockWidth,this.blockHeight),b=new THREE.MeshBasicMaterial({color:16777215,side:THREE.DoubleSide,map:this.cursorTexture,transparent:!0}),d=new THREE.Mesh(c,b);d.position.x=-this.blockWidth/2;a.add(d);c=new THREE.Mesh(c,b);c.position.x=this.blockWidth/2;a.add(c);a.position.z=this.boardRadius+this.blockDepth;return a};
PuzzleGame.prototype.closeTube=function(a){var c=TWEEN.Easing.Cubic.Out;(new TWEEN.Tween(this.tube.children[0].position)).to({y:-this.boardPixelHeight/2},1E3).easing(c).start();(new TWEEN.Tween(this.tube.children[0].rotation)).to({y:-HALF_PI},1E3).easing(c).start();(new TWEEN.Tween(this.tube.children[1].position)).to({y:this.boardPixelHeight/2},1E3).easing(c).start();(new TWEEN.Tween(this.tube.children[1].rotation)).to({y:HALF_PI},1E3).easing(c).start();setTimeout(a,1E3)};
PuzzleGame.prototype.openTube=function(a){var c=TWEEN.Easing.Cubic.Out;(new TWEEN.Tween(this.tube.children[0].position)).to({y:-this.boardPixelHeight+1},1E3).easing(c).start();(new TWEEN.Tween(this.tube.children[0].rotation)).to({y:0},1E3).easing(c).start();(new TWEEN.Tween(this.tube.children[1].position)).to({y:this.boardPixelHeight-1},1E3).easing(c).start();(new TWEEN.Tween(this.tube.children[1].rotation)).to({y:0},1E3).easing(c).start();setTimeout(a,1E3)};
PuzzleGame.prototype.generateTube=function(){var a=new THREE.Object3D,c=this.boardRadius+this.blockDepth/2+5,b=new THREE.MeshBasicMaterial({color:2236962,side:THREE.DoubleSide,map:this.tubeTexture}),d=new THREE.CylinderGeometry(c,c,this.boardPixelHeight,this.boardWidth,1,!1),c=new THREE.Mesh(d,b);c.position.y=-(this.boardPixelHeight/2);c.rotation.y=-HALF_PI;b=new THREE.Mesh(d,b);b.position.y=this.boardPixelHeight/2;b.rotation.y=HALF_PI;a.add(c);a.add(b);return a};
PuzzleGame.prototype.generateCylinderDepthFilter=function(){var a=new THREE.Object3D,c=new THREE.MeshBasicMaterial({color:0,side:THREE.DoubleSide,transparent:!0,opacity:.6}),b=new THREE.PlaneGeometry(2*(this.boardRadius+this.blockDepth),this.boardPixelHeight),d=new THREE.Mesh(b,c),b=this.boardRadius+this.blockDepth,c=new THREE.MeshBasicMaterial({color:16777215,side:THREE.DoubleSide,transparent:!0,opacity:.1,depthWrite:!1,depthTest:!1}),b=new THREE.CylinderGeometry(b,b,this.boardPixelHeight,this.boardWidth,
1,!0,-HALF_PI,PI);new THREE.Mesh(b,c);a.add(d);return a};PuzzleGame.prototype.keyPress=function(a){a.preventDefault();if(this.hasControl)switch(a.keyCode){case 32:this.swapSelectedBlocks();break;case 38:this.adjustSelector("up");break;case 40:this.adjustSelector("down");break;case 37:this.adjustSelector("left");break;case 39:this.adjustSelector("right")}};PuzzleGame.prototype.swapSelectedBlocks=function(){this.swapBlocks(this.selectorX,this.selectorY,this.selectorX-1)};
PuzzleGame.prototype.checkForMatches=function(){if(this.hasControl){for(var a=0,c=[],b=0;b<this.boardHeight;b++)for(var d=0;d<this.boardWidth;d++)if(null!=this.gameGrid[d][b]&&!this.gameGrid[d][b].userData.locked){var e=this.gameGrid[d][b].userData.blockType,f=[d],g=d+1;for(g==this.boardWidth&&(g=0);g!=d&&null!=this.gameGrid[g][b]&&!this.gameGrid[g][b].userData.locked&&!this.gameGrid[g][b].userData.alreadyMatchedX;){var h=this.gameGrid[g][b].userData.blockType;if(h!=e)break;f.push(g);g++;g==this.boardWidth&&
(g=0)}if(3<=f.length)for(this.matches++,a++,h=0;h<f.length;h++)this.gameGrid[f[h]][b].userData.alreadyMatchedX=!0,c.push({x:f[h],y:b});f=[b];g=b+1;if(g!=this.boardHeight){for(;g!=b&&null!=this.gameGrid[d][g]&&!this.gameGrid[d][g].userData.locked&&!this.gameGrid[d][g].userData.alreadyMatchedY;){h=this.gameGrid[d][g].userData.blockType;if(h!=e)break;f.push(g);g++;if(g==this.boardHeight)break}if(3<=f.length)for(this.matches++,a++,h=0;h<f.length;h++)this.gameGrid[d][f[h]].userData.alreadyMatchedY=!0,
c.push({x:d,y:f[h]})}}0<c.length&&(this.chainCount++,null!==this.chainTimer&&clearTimeout(this.chainTimer),this.chainTimer=setTimeout(this.resetChain.bind(this),this.dropDelay+600),1<this.chainCount&&console.log("CHAIN "+this.chainCount));for(b=0;b<c.length;b++)this.score+=a*this.chainCount,this.destroyBlock(c[b].x,c[b].y)}};PuzzleGame.prototype.resetChain=function(){this.chainCount=0;this.chainTimer=null};
PuzzleGame.prototype.swapBlocks=function(a,c,b){-1==b&&(b=this.boardWidth-1);var d=this.gameGrid[a][c],e=this.gameGrid[b][c];if(!(null!=d&&d.userData.locked||null!=e&&e.userData.locked)){var f=this;null!==d&&(this.animationQueue++,(new TWEEN.Tween(d.position)).to({x:this.calcXBlockPos(b),z:this.calcZBlockPos(b)},50).easing(TWEEN.Easing.Bounce.Out).start().onComplete(function(){f.animationQueue--}),d.rotation.y=this.calcRBlockPos(b));null!==e&&(this.animationQueue++,(new TWEEN.Tween(e.position)).to({x:this.calcXBlockPos(a),
z:this.calcZBlockPos(a)},50).easing(TWEEN.Easing.Bounce.Out).start().onComplete(function(){f.animationQueue--}),e.rotation.y=this.calcRBlockPos(a));this.gameGrid[a][c]=e;this.gameGrid[b][c]=d;null!=d&&null==e?(0<=c-1&&null==this.gameGrid[b][c-1]&&(this.lockBlocksStartingAtPoint(b,c),this.animationQueue++,setTimeout(this.dropBlocksStartingAtPoint.bind(this,b,c),this.dropDelay)),this.lockBlocksStartingAtPoint(a,c+1),this.animationQueue++,setTimeout(this.dropBlocksStartingAtPoint.bind(this,a,c+1),this.dropDelay)):
null!=e&&null==d&&(0<=c-1&&null==this.gameGrid[a][c-1]&&(this.lockBlocksStartingAtPoint(a,c),this.animationQueue++,setTimeout(this.dropBlocksStartingAtPoint.bind(this,a,c),this.dropDelay)),this.lockBlocksStartingAtPoint(b,c+1),this.animationQueue++,setTimeout(this.dropBlocksStartingAtPoint.bind(this,b,c+1),this.dropDelay));this.checkForMatches()}};
PuzzleGame.prototype.destroyBlock=function(a,c){null==this.gameGrid[a][c]||this.gameGrid[a][c].userData.locked||(this.animationQueue++,this.gameGrid[a][c].userData.locked=!0,this.gameGrid[a][c].userData.exploding=!0,setTimeout(this.deleteBlock.bind(this,a,c),500))};PuzzleGame.prototype.lockBlocksStartingAtPoint=function(a,c){for(var b=c;b<this.boardHeight&&null!==this.gameGrid[a][b]&&!this.gameGrid[a][b].userData.exploding;b++)this.gameGrid[a][b].userData.locked=!0};
PuzzleGame.prototype.deleteBlock=function(a,c){this.gameGrid[a][c].userData.exploding=!1;this.gameBoard.remove(this.gameGrid[a][c]);this.gameGrid[a][c]=null;this.animationQueue--;this.lockBlocksStartingAtPoint(a,c+1);this.animationQueue++;setTimeout(this.dropBlocksStartingAtPoint.bind(this,a,c+1),this.dropDelay)};
PuzzleGame.prototype.dropBlocksStartingAtPoint=function(a,c){this.animationQueue--;for(var b=!0,d=c;d<this.boardHeight&&null!==this.gameGrid[a][d]&&!this.gameGrid[a][d].userData.exploding;d++)null!==this.gameGrid[a][d-1]?b=this.gameGrid[a][d].userData.locked=!1:(sThis=this,this.animationQueue++,(new TWEEN.Tween(this.gameGrid[a][d].position)).to({y:this.calcYBlockPos(d-1)},200).easing(TWEEN.Easing.Bounce.Out).start().onComplete(function(){sThis.animationQueue--}),this.gameGrid[a][d-1]=this.gameGrid[a][d],
this.gameGrid[a][d]=null);b?0<=c-1&&(this.animationQueue++,this.dropBlocksStartingAtPoint(a,c-1)):this.checkForMatches()};
PuzzleGame.prototype.adjustSelector=function(a){switch(a){case "up":this.selectorY++;break;case "down":this.selectorY--;break;case "left":this.selectorX++;this.selectorX>=this.boardWidth&&(this.gameBoard.rotation.y=this.nextRow.rotation.y=-1*this.circlePieceSize-HALF_PI-this.circlePieceSize/2);break;case "right":this.selectorX--,0>this.selectorX&&(this.gameBoard.rotation.y=this.nextRow.rotation.y=this.circlePieceSize*this.boardWidth-HALF_PI-this.circlePieceSize/2)}this.selectorY>=this.boardHeight&&
(this.selectorY=this.boardHeight-1);0>this.selectorY&&(this.selectorY=0);this.selectorX>=this.boardWidth&&(this.selectorX=0);0>this.selectorX&&(this.selectorX=this.boardWidth-1);this.focusCameraOnSelection()};
PuzzleGame.prototype.focusCameraOnSelection=function(){var a=this.circlePieceSize*this.selectorX-HALF_PI-this.circlePieceSize/2;(new TWEEN.Tween(this.gameBoard.rotation)).to({y:a},200).easing(TWEEN.Easing.Exponential.Out).start();(new TWEEN.Tween(this.nextRow.rotation)).to({y:a},200).easing(TWEEN.Easing.Exponential.Out).start();this.updateCursorPos()};PuzzleGame.prototype.calcYBlockPos=function(a){return a*this.blockHeight+this.blockHeight/2};
PuzzleGame.prototype.calcXBlockPos=function(a){return Math.cos(this.circlePieceSize*a)*this.boardRadius};PuzzleGame.prototype.calcZBlockPos=function(a){return Math.sin(this.circlePieceSize*a)*this.boardRadius};PuzzleGame.prototype.calcRBlockPos=function(a){return-this.circlePieceSize*a+HALF_PI};
PuzzleGame.prototype.loadMap=function(a){var c=this;this.fileLoader.load("maps/"+a+".txt",function(a){a=a.replace(/\r\n/g,"\r");a=a.split("\r");for(var b=[],e=a.length-1;0<=e;e--){for(var f=[],g=a[e].split(""),h=g.length-1;0<=h;h--)f.push(g[h]);b.push(f)}c.resetGame(b)})};
PuzzleGame.prototype.generateNextRow=function(){this.hasOwnProperty("nextRow")&&this.scene.remove(this.nextRow);for(var a=[],c=Object.keys(this.blockColors),b=0;b<c.length-this.handicap;b++)a.push(c[b]);this.nextRow=new THREE.Object3D;var a=this.generateNextRowMeshArray(a),d;for(d in a)this.nextRow.add(a[d]);this.scene.add(this.nextRow);this.updateNextRowPos();this.nextRow.rotation.y=this.circlePieceSize*this.selectorX-HALF_PI-this.circlePieceSize/2;this.rowsCreated++};
PuzzleGame.prototype.generateNextRowMeshArray=function(a){for(var c=[],b=new THREE.BoxGeometry(this.blockWidth,this.blockHeight,this.blockDepth),d=0;d<this.boardWidth;d++)c[d]=null;for(d=0;d<this.boardWidth;d++){for(var e=a.slice(0),f="",g="",h=-2;2>=h;h++)if(0!=h){var k=c[(d-h+this.boardWidth)%this.boardWidth];if(null!==k){var k=k.userData.blockType,m=e.indexOf(k);k==f&&-1!==m&&1<e.length&&e.splice(m,1);f=k}0>h||(k=this.gameGrid[d][h-1],null!==k&&(k=k.userData.blockType,m=e.indexOf(k),k==g&&-1!==
m&&1<e.length&&e.splice(m,1),g=k))}e=e[Math.floor(Math.random()*e.length)];f=new THREE.Color(this.blockColors[e]);f.add(new THREE.Color(5263440));f=new THREE.MeshBasicMaterial({color:f,map:this.blockTextures[e],transparent:!0,opacity:1});f=new THREE.Mesh(b,f);f.userData.blockType=e;f.position.x=this.calcXBlockPos(d);f.position.y=this.calcYBlockPos(0);f.position.z=this.calcZBlockPos(d);f.rotation.y=this.calcRBlockPos(d);c[d]=f}return c};
PuzzleGame.prototype.generateBlockMesh=function(a,c,b){var d=new THREE.BoxGeometry(this.blockWidth,this.blockHeight,this.blockDepth),e=new THREE.MeshBasicMaterial({color:this.blockColors[a],map:this.blockTextures[a]}),d=new THREE.Mesh(d,e);d.userData.blockType=a;d.userData.locked=!1;d.userData.exploding=!1;d.userData.alreadyMatchedX=!1;d.userData.alreadyMatchedY=!1;d.position.x=this.calcXBlockPos(c);d.position.y=this.calcYBlockPos(b);d.position.z=this.calcZBlockPos(c);d.rotation.y=this.calcRBlockPos(c);
return d};PuzzleGame.prototype.getBlockAt=function(a,c){a=(a+this.boardWidth)%this.boardWidth;c=(c+this.boardHeight)%this.boardHeight;return!1===a in this.gameGrid||!1===c in this.gameGrid[a]||null===this.gameGrid[a][c]?!1:this.gameGrid[a][c]};
PuzzleGame.prototype.generateMap=function(a,c){for(var b=[],d=0;d<this.boardWidth;d++){for(var e=[],f=0;f<this.boardHeight;f++)e.push(null);b.push(e)}for(d=0;d<this.boardWidth;d++)for(e=0;e<this.boardHeight;e++)if(e>this.boardHeight*c)b[d][e]=null;else{for(var f=a.slice(0),g="",h="",k=-2;2>=k;k++)if(0!=k){var m=b[(d-k+this.boardWidth)%this.boardWidth][e];if(null!==m){var w=f.indexOf(m);m==g&&-1!==w&&1<f.length&&f.splice(w,1);g=m}m=b[d][(e-k+this.boardHeight)%this.boardHeight];null!==m&&(w=f.indexOf(m),
m==h&&-1!==w&&1<f.length&&f.splice(w,1),h=m)}b[d][e]=f[Math.floor(Math.random()*f.length)]}return b};PuzzleGame.prototype.cylinder=function(a){a=new THREE.Object3D;for(var c=[],b=Object.keys(this.blockColors),d=0;d<b.length-this.handicap;d++)c.push(b[d]);c=this.generateMap(c,.3);for(b=0;b<this.boardWidth;b++){d=[];this.stackHeights[b]=this.boardHeight;for(var e=0;e<this.boardHeight;e++){var f=c[b][e];null==f?d.push(null):(f=this.generateBlockMesh(f,b,e),d.push(f),a.add(f))}this.gameGrid.push(d)}return a};
PuzzleGame.prototype.onWindowResize=function(){var a=window.innerWidth,c=window.innerHeight;this.camera.aspect=a/c;this.camera.updateProjectionMatrix();this.renderer.setSize(a,c)};PuzzleGame.prototype.updateTowerPos=function(){this.gameBoard.position.y=-this.halfBoardPixelHeight+this.upOffset;return this.gameBoard.position.y};PuzzleGame.prototype.updateCursorPos=function(){this.cursorObj.position.y=this.calcYBlockPos(this.selectorY)-this.halfBoardPixelHeight+this.upOffset;this.debugSelectionUpdate()};
PuzzleGame.prototype.updateNextRowPos=function(){this.nextRow.position.y=this.calcYBlockPos(-1)-this.halfBoardPixelHeight-this.blockHeight/2+this.upOffset};PuzzleGame.prototype.animate=function(){requestAnimationFrame(this.animate.bind(this));this.stats.begin();this.render();this.stats.end()};
PuzzleGame.prototype.gameAnimations=function(){performance.now();this.menuObj.rotation.y=HALF_PI/10*Math.sin(this.piTimer);if(this.gameActive){for(var a={},c=0;c<this.boardWidth;c++)a[c]=!1,null!==this.gameGrid[c][this.boardHeight-3]&&(a[c]=!0);for(c=0;c<this.boardWidth;c++)for(var b=0;b<this.boardHeight;b++){var d=this.gameGrid[c][b];null!==d&&d.userData.exploding&&(d.scale.x=d.scale.y=.1*Math.sin(16*this.piTimer)+.8);null!==d&&(d.rotation.z=a[c]?Math.cos(3*this.piTimer)*PI/32:0)}for(c=0;c<this.nextRow.children.length;c++)this.nextRow.children[c].rotation.z=
a[c]?Math.cos(3*this.piTimer)*PI/32:0;for(a=0;a<this.cursorObj.children.length;a++)this.cursorObj.children[a].scale.x=this.cursorObj.children[a].scale.y=.05*Math.sin(this.piTimer)+1}};PuzzleGame.prototype.render=function(){TWEEN.update();this.gameAnimations();this.renderer.render(this.scene,this.camera);this.piTimer+=.05;this.piTimer>TWO_PI&&(this.piTimer=0)};PuzzleGame.prototype.debugLoadMap=function(){this.loadMap("map"+this.debugMapNumber)};
PuzzleGame.prototype.debugDelete10=function(){for(var a=0;10>a;a++)this.destroyBlock(Math.floor(Math.random()*this.boardWidth),Math.floor(Math.random()*this.boardHeight))};
PuzzleGame.prototype.debugSelectionUpdate=function(){if(this.debugSelection){for(var a=0;a<this.boardWidth;a++)for(var c=0;c<this.boardHeight;c++)null!==this.gameGrid[a][c]&&this.gameGrid[a][c].material.color.setHex(this.gameGrid[a][c].userData.color);null!==this.gameGrid[this.selectorX][this.selectorY]&&this.gameGrid[this.selectorX][this.selectorY].material.color.setHex(65280);a=this.selectorX-1;0>a&&(a=this.boardWidth-1);null!==this.gameGrid[a][this.selectorY]&&this.gameGrid[a][this.selectorY].material.color.setHex(65280)}};
PuzzleGame.prototype.initDatGui=function(){var a=new dat.GUI,c=a.addFolder("GAMEPLAY");c.add(this,"handicap",0,4).step(1).listen();c.add(this,"pushDelay",0,200).step(1).listen();c.add(this,"matches").listen();c.add(this,"score").listen();c.add(this,"chainCount").listen();c.add(this,"rowsCreated").listen();c.add(this,"startGame");c.open();a.addFolder("VB13")};
PuzzleGame.prototype.initTouch=function(){this.touchTimer=null;this.yTouchChain=this.xTouchChain=0;this.renderer.domElement.addEventListener("touchstart",this.onDocumentTouchStart.bind(this),!1);this.renderer.domElement.addEventListener("touchmove",this.onDocumentTouchMove.bind(this),!1)};
PuzzleGame.prototype.onDocumentTouchStart=function(a){var c=this;1===a.touches.length&&(null==this.touchTimer?this.touchTimer=setTimeout(function(){c.touchTimer=null},200):(clearTimeout(this.touchTimer),this.touchTimer=null,10>Math.abs(this.xTouchChain)&&10>Math.abs(this.yTouchChain)&&this.swapSelectedBlocks()),a.preventDefault(),this.lastXTouch=a.touches[0].pageX,this.lastYTouch=a.touches[0].pageY,this.yTouchChain=this.xTouchChain=0)};
PuzzleGame.prototype.onDocumentTouchMove=function(a){if(1===a.touches.length){a.preventDefault();var c=a.touches[0].pageX;a=a.touches[0].pageY;var b=c-this.lastXTouch,d=a-this.lastYTouch;this.lastXTouch=c;this.lastYTouch=a;this.xTouchChain+=b;this.yTouchChain+=d;-30>this.xTouchChain?(this.adjustSelector("left"),this.xTouchChain=0):30<this.xTouchChain&&(this.adjustSelector("right"),this.xTouchChain=0);-30>this.yTouchChain?(this.adjustSelector("up"),this.yTouchChain=0):30<this.yTouchChain&&(this.adjustSelector("down"),
this.yTouchChain=0)}};new PuzzleGame;
